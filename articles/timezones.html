<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>In the zone • gghourglass</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="In the zone">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gghourglass</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/solar-cycles.html">From dusk till dawn</a></li>
    <li><a class="dropdown-item" href="../articles/timezones.html">In the zone</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pepijn-devries/gghourglass/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>In the zone</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pepijn-devries/gghourglass/blob/master/vignettes/timezones.Rmd" class="external-link"><code>vignettes/timezones.Rmd</code></a></small>
      <div class="d-none name"><code>timezones.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>This vignette presents some vital aspects of time zones when adding
‘hourglass’ layers to your plot</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load required namespaces for this vignette</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pepijn-devries.github.io/gghourglass/">gghourglass</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<p>Whether it’s day or night depends on where you are on the Earth’s
globe. This is why you need to pass the longitude and latitude when you
wish to decorate your plot with ribbons indicating night (or day)
time.</p>
<p>But which hour of the day is it anyway? Well, that of course depends
on the time zone that you use as a reference. The <code><a href="../reference/bats.html">?bats</a></code>
dataset, included with the <code>gghourglass</code> package, expresses
the date and time in Coordinated Universal Time (UTC). This makes sense
when your observations are close to the prime meridian, but not so much
when you are in a different time zone (such as the Central Time Zone in
the United States).</p>
<p>Let’s make this more clear through an example. We start by plotting
the provided observations of bat call sequences:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## get example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bats</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## subset example date to the year 2018</span></span>
<span><span class="va">bats_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">bats</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">RECDATETIME</span>, <span class="st">"%Y"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"2019"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## retrieve monitoring location</span></span>
<span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bats</span>, <span class="st">"monitoring"</span><span class="op">)</span><span class="op">$</span><span class="va">longitude</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">bats</span>, <span class="st">"monitoring"</span><span class="op">)</span><span class="op">$</span><span class="va">latitude</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## plot the data</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bats_sub</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RECDATETIME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="co">## annotate sunset until sunrise</span></span>
<span>    <span class="fu"><a href="../reference/annotate_daylight.html">annotate_daylight</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sunset"</span>, <span class="st">"sunrise"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="co">## annotate dusk until dawn</span></span>
<span>    <span class="fu"><a href="../reference/annotate_daylight.html">annotate_daylight</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dusk"</span>, <span class="st">"dawn"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="co">## add hourglass geometry to plot</span></span>
<span>    <span class="fu"><a href="../reference/geom_hourglass.html">geom_hourglass</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="co">## add informative labels</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Time of day"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Ftimezones-plot-utc-1.png" width="672"></p>
<p>Note that the <code><a href="../reference/geom_hourglass.html">geom_hourglass()</a></code> layer automatically uses
the time zone as specified by the data (UTC). If you wish to display it
in a different time zone, such as for instance Central European Time
(CET), you simply mutate the time zone of the observations with
<code><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">lubridate::with_tz()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/gg-add.html" class="external-link">%+%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">bats_sub</span>, RECDATETIME <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span><span class="va">RECDATETIME</span>, <span class="st">"CET"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BB0000;">✖</span> You are displaying a timezone that uses daylight saving time.</span></span>
<span><span class="co">#&gt; It may contain ambiguous time stamps.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Convert the object to a time zone without daylight time (e.g. 'UTC').</span></span>
<span><span class="co">#&gt; You can use `lubridate::with_tz()`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> You are displaying a timezone that uses daylight saving time.</span></span>
<span><span class="co">#&gt; It may contain ambiguous time stamps.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Convert the object to a time zone without daylight time (e.g. 'UTC').</span></span>
<span><span class="co">#&gt; You can use `lubridate::with_tz()`.</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Ftimezones-plot-cet-1.png" width="672"></p>
<p>Hold on, why is the ribbon indicating night time jagged? This is
because CET has summer daylight-saving time which causes the night-time
to shift one hour.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pepijn de Vries.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
